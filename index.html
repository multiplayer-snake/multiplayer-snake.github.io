<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Snake Game</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background-color: #111;
      color: #0f0;
      font-family: 'Courier New', Courier, monospace;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }
    canvas {
      border: 2px solid #0f0;
      background-color: #000;
    }
    h1 {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <canvas id="game" width="520" height="520"></canvas>
<script>
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');

  const gridSize = 20;
  const tileCount = canvas.width / gridSize;

  let snake, velocity, food, score, lives, level;
  let started = false;
  let paused = false;
  let speed = 1000;
  let interval;

  function initGame() {
    snake = [{x: 20, y: 20}];
    velocity = {x: 0, y: 0};
    food = spawnFood();
    score = 0;
    lives = 6;
    level = 1;
    speed = 100;
    started = false;
    paused = false;
    clearInterval(interval);
    interval = setInterval(gameLoop, speed);
  }

  function spawnFood() {
    return {
      x: Math.floor(Math.random() * tileCount),
      y: Math.floor(Math.random() * tileCount)
    };
  }

  function gameLoop() {
    if (!started || paused) {
      draw(); // Still draw current frame
      return;
    }

    const head = {x: snake[0].x + velocity.x, y: snake[0].y + velocity.y};

    if (
      head.x < 0 || head.y < 0 ||
      head.x >= tileCount || head.y >= tileCount ||
      snake.some(part => part.x === head.x && part.y === head.y)
    ) {
      lives--;
      if (lives <= 0) {
        alert(`Game Over! Final Score: ${score}, Level: ${level}`);
        return initGame();
      } else {
        alert(`Oops! Lives remaining: ${lives}`);
        snake = [{x: 10, y: 10}];
        velocity = {x: 0, y: 0};
        started = false;
        return;
      }
    }

    snake.unshift(head);

    if (head.x === food.x && head.y === food.y) {
      score++;
      food = spawnFood();

      // Level up every 5 points
      if (score % 5 === 0) {
        level++;
        speed = Math.max(50, speed - 20);
        clearInterval(interval);
        interval = setInterval(gameLoop, speed);
      }

    } else {
      snake.pop();
    }

    draw();
  }

  function draw() {
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Draw food
    ctx.fillStyle = '#f00';
    ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize, gridSize);

    // Draw snake
    ctx.fillStyle = '#0f0';
    for (let part of snake) {
      ctx.fillRect(part.x * gridSize, part.y * gridSize, gridSize, gridSize);
    }

    // UI
    ctx.fillStyle = '#00E8FF';
    ctx.font = "16px Courier New";
    ctx.fillText(`Score: ${score}`, 10, canvas.height - 10);
    ctx.fillText(`Lives: ${lives}`, 100, canvas.height - 10);
    ctx.fillText(`Level: ${level}`, 180, canvas.height - 10);
    if (paused) ctx.fillText(`PAUSED`, 300, canvas.height - 10);
  }

  document.addEventListener('keydown', e => {
    if (e.key === 'p' || e.key === 'P') {
      paused = !paused;
      return;
    }

    if (!started) started = true;

    switch (e.key) {
      case 'ArrowUp':
        if (velocity.y === 0) velocity = {x: 0, y: -1};
        break;
      case 'ArrowDown':
        if (velocity.y === 0) velocity = {x: 0, y: 1};
        break;
      case 'ArrowLeft':
        if (velocity.x === 0) velocity = {x: -1, y: 0};
        break;
      case 'ArrowRight':
        if (velocity.x === 0) velocity = {x: 1, y: 0};
        break;
    }
  });

  initGame();
</script>

</body>
</html>
